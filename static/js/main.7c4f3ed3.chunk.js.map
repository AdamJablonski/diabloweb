{"version":3,"sources":["api/game.worker.js","serviceWorker.js","api/load_spawn.js","api/loader.js","api/sound.js","App.js","index.js","fs.js"],"names":["module","exports","Worker","__webpack_require__","p","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","SpawnSize","load_spawn","_x","_x2","_load_spawn","apply","this","arguments","_callee","api","fs","file","spawn","data","regenerator_default","a","wrap","_context","prev","next","files","get","byteLength","delete","axios","request","url","process","responseType","onDownloadProgress","e","onProgress","text","loaded","total","headers","Cache-Control","sent","Error","Uint8Array","set","update","slice","abrupt","stop","onRender","ctx","_ref","bitmap","images","clip","belt","transferFromImageBitmap","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","done","_ref5","value","x","y","w","h","image","createImageData","putImageData","err","return","length","save","font","x0","y0","x1","y1","beginPath","rect","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_ref4","str","color","r","g","b","fillStyle","concat","fillText","restore","updateBelt","audio","mpq","context","offscreen","name","canvas","getContext","alpha","Promise","resolve","reject","worker","addEventListener","_ref6","action","func","_len","params","Array","_key","postMessage","batch","Object","toConsumableArray","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_ref8","setCursorPos","openKeyboard","open","stop_all","onError","stack","onExit","setCurrentSave","transfer","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_ref11","slicedToArray","push","buffer","load_game","do_load_game","AudioContext","webkitAudioContext","create_sound","duplicate_sound","play_sound","set_volume","stop_sound","delete_sound","sounds","Map","id","channels","rate","createBuffer","i","copyToChannel","subarray","gain","createGain","panner","StereoPannerNode","pan","srcId","src","volume","loop","source","Math","pow","relVolume","createBufferSource","connect","destination","start","_ref3","sound","clear","init_sound","reportLink","retail","message","URL","searchParams","split","map","line","join","userAgent","toString","ReactGA","initialize","pageview","TOUCH_MOVE","TOUCH_RMB","Link","children","props","objectWithoutProperties","react_default","createElement","assign","target","rel","App","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","started","loading","touch","dropping","has_spawn","cursorPos","touchButtons","touchCtx","touchMods","touchBelt","create_fs","onDrop","dataTransfer","items","kind","getAsFile","getDropFile","preventDefault","setState","onDragEnter","setDropping","onDragOver","isDropFile","onDragLeave","downloadSave","saveName","download","stopPropagation","onResize","document","exitPointerLock","onPointerLockChange","screen","innerHeight","height","pointerLocked","game","onMouseMove","_this$mousePos","mousePos","eventMods","onMouseDown","_this$mousePos2","requestPointerLock","mouseButton","onMouseUp","_this$mousePos3","onKeyDown","keyCode","key","showKeyboard","charCodeAt","clearKeySel","onMenu","onKeyUp","onKeyboard","_this2","keyboard","valid","substring","values","_","parseFile","touchButton","touchCanvas","onFullscreenChange","fullscreenElement","element","onTouchStart","updateTouchButton","touches","_this$mousePos4","onTouchMove","_this$mousePos5","onTouchEnd","prevTc","_this$mousePos6","index","setTouchButton","requestFullscreen","setCanvas","setElement","setKeyboard","setTouch0","setTouch_","bind","assertThisInitialized","setTouch1","setTouch2","setTouch3","setTouchBelt_","setTouch4","setTouch5","_this3","inc","_ref2","max","classList","add","focus","remove","blur","_this4","getBoundingClientRect","left","right","top","bottom","setTimeout","progress","reload","idx","slot","style","display","drawImage","used","Set","pos","has","drawBelt","_this5","upload","removeEventListener","event","category","passive","capture","pointerLockElement","mozPointerLockElement","min","movementX","movementY","clientX","clientY","round","button","shiftKey","ctrlKey","altKey","len","setSelectionRange","use","toggle","now","performance","beltTime","release","_this6","touchOther","btn","_loop","identifier","stick","find","t","panPos","v","indexOf","original","_ret","setTouchMod","dx","dy","step","offsetHeight","abs","width","appendChild","_this7","_this$state","className","classNames","ref","active","type","onChange","spellCheck","App_Link","href","onClick","htmlFor","accept","React","Component","ReactDOM","render","src_App_0","getElementById","origin","fetch","response","contentType","status","ready","unregister","checkValidServiceWorker","importStorage","frame","method","contentWindow","body","downloadFile","store","blob","lnk","C_Projects_diabloweb_diabloweb_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","toLowerCase","Blob","createObjectURL","setAttribute","click","removeChild","revokeObjectURL","downloadSaves","_callee2","_context2","keys","t0","t1","finish","readFile","reader","FileReader","onload","result","onerror","onabort","readAsArrayBuffer","uploadFile","_callee3","_context3","_x7","_create_fs","_callee4","load","_i","_Object$entries","_ref7","_name","_data","_files","_context4","IdbKvStore","json","entries","C_Projects_diabloweb_diabloweb_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","t2","DownloadFile","DownloadSaves","t3"],"mappings":"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","file":"static/js/main.7c4f3ed3.chunk.js","sourcesContent":["module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"e7446815748fd1b8359c.worker.js\");\n};","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import axios from 'axios';\r\n\r\nconst SpawnSize = 50274091;\r\n\r\nexport { SpawnSize };\r\n\r\nexport default async function load_spawn(api, fs) {\r\n  let file = fs.files.get('spawn.mpq');\r\n  if (file && file.byteLength !== SpawnSize) {\r\n    fs.files.delete('spawn.mpq');\r\n    await fs.delete('spawn.mpq');\r\n    file = null;\r\n  }\r\n  if (!file) {\r\n    const spawn = await axios.request({\r\n      url: process.env.PUBLIC_URL + '/spawn.mpq',\r\n      responseType: 'arraybuffer',\r\n      onDownloadProgress: e => {\r\n        if (api.onProgress) {\r\n          api.onProgress({text: 'Downloading...', loaded: e.loaded, total: e.total || SpawnSize});\r\n        }\r\n      },\r\n      headers: {\r\n        'Cache-Control': 'max-age=31536000'\r\n      }\r\n    });\r\n    if (spawn.data.byteLength !== SpawnSize) {\r\n      throw Error(\"Invalid spawn.mpq size. Try clearing cache and refreshing the page.\");\r\n    }\r\n    const data = new Uint8Array(spawn.data);\r\n    fs.files.set('spawn.mpq', data);\r\n    fs.update('spawn.mpq', data.slice());\r\n  }\r\n  return fs;\r\n}\r\n","import Worker from './game.worker.js';\r\nimport init_sound from './sound';\r\nimport load_spawn from './load_spawn';\r\n\r\nfunction onRender(api, ctx, {bitmap, images, text, clip, belt}) {\r\n  if (bitmap) {\r\n    ctx.transferFromImageBitmap(bitmap);\r\n  } else {\r\n    for (let {x, y, w, h, data} of images) {\r\n      const image = ctx.createImageData(w, h);\r\n      image.data.set(data);\r\n      ctx.putImageData(image, x, y);\r\n    }\r\n    if (text.length) {\r\n      ctx.save();\r\n      ctx.font = 'bold 13px Times New Roman';\r\n      if (clip) {\r\n        const {x0, y0, x1, y1} = clip;\r\n        ctx.beginPath();\r\n        ctx.rect(x0, y0, x1 - x0, y1 - y0);\r\n        ctx.clip();\r\n      }\r\n      for (let {x, y, text: str, color} of text) {\r\n        const r = ((color >> 16) & 0xFF);\r\n        const g = ((color >> 8) & 0xFF);\r\n        const b = (color & 0xFF);\r\n        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;\r\n        ctx.fillText(str, x, y + 22);\r\n      }\r\n      ctx.restore();\r\n    }\r\n  }\r\n\r\n  api.updateBelt(belt);\r\n}\r\n\r\nfunction testOffscreen() {\r\n  return false;\r\n  /*try {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const offscreen = canvas.transferControlToOffscreen();\r\n    const context = offscreen.getContext(\"2d\");\r\n    return context != null;\r\n  } catch (e) {\r\n    return false;\r\n  }*/\r\n}\r\n\r\nasync function do_load_game(api, audio, mpq) {\r\n  const fs = await api.fs;\r\n  let spawn = true;\r\n  if (mpq) {\r\n    if (!mpq.name.match(/^spawn\\.mpq$/i)) {\r\n      spawn = false;\r\n      fs.files.delete('spawn.mpq');\r\n    }\r\n  } else {\r\n    await load_spawn(api, fs);\r\n  }\r\n\r\n  let context = null, offscreen = false;\r\n  if (testOffscreen()) {\r\n    context = api.canvas.getContext(\"bitmaprenderer\");\r\n    offscreen = true;\r\n  } else {\r\n    context = api.canvas.getContext(\"2d\", {alpha: false});\r\n  }\r\n  return await new Promise((resolve, reject) => {\r\n    try {\r\n      const worker = new Worker();\r\n      worker.addEventListener(\"message\", ({data}) => {\r\n        switch (data.action) {\r\n        case \"loaded\":\r\n          resolve((func, ...params) => worker.postMessage({action: \"event\", func, params}));\r\n          break;\r\n        case \"render\":\r\n          onRender(api, context, data.batch);\r\n          break;\r\n        case \"audio\":\r\n          audio[data.func](...data.params);\r\n          break;\r\n        case \"audioBatch\":\r\n          for (let {func, params} of data.batch) {\r\n            audio[func](...params);\r\n          }\r\n          break;\r\n        case \"fs\":\r\n          fs[data.func](...data.params);\r\n          break;\r\n        case \"cursor\":\r\n          api.setCursorPos(data.x, data.y);\r\n          break;\r\n        case \"keyboard\":\r\n          api.openKeyboard(data.open);\r\n          break;\r\n        case \"error\":\r\n          audio.stop_all();\r\n          api.onError(data.error, data.stack);\r\n          break;\r\n        case \"failed\":\r\n          reject(Error(data.stack || data.error));\r\n          break;\r\n        case \"progress\":\r\n          api.onProgress({text: data.text, loaded: data.loaded, total: data.total});\r\n          break;\r\n        case \"exit\":\r\n          api.onExit();\r\n          break;\r\n        case \"current_save\":\r\n          api.setCurrentSave(data.name);\r\n          break;\r\n        default:\r\n        }\r\n      });\r\n      const transfer= [];\r\n      for (let [, file] of fs.files) {\r\n        transfer.push(file.buffer);\r\n      }\r\n      worker.postMessage({action: \"init\", files: fs.files, mpq, spawn, offscreen}, transfer);\r\n      delete fs.files;\r\n    } catch (e) {\r\n      reject(e);\r\n    }\r\n  });\r\n}\r\n\r\nexport default function load_game(api, mpq) {\r\n  const audio = init_sound();\r\n  return do_load_game(api, audio, mpq);\r\n}\r\n","function no_sound() {\r\n  return {\r\n    create_sound: () => 0,\r\n    duplicate_sound: () => 0,\r\n    play_sound: () => undefined,\r\n    set_volume: () => undefined,\r\n    stop_sound: () => undefined,\r\n    delete_sound: () => undefined,\r\n  };\r\n}\r\n\r\nexport default function init_sound() {\r\n  const AudioContext = window.AudioContext || window.webkitAudioContext;\r\n  if (!AudioContext) {\r\n    return no_sound();\r\n  }\r\n\r\n  let context = null;\r\n  try {\r\n    context = new AudioContext();\r\n  } catch (e) {\r\n  }\r\n  const sounds = new Map();\r\n\r\n  return {\r\n    create_sound(id, data, length, channels, rate) {\r\n      if (!context) {\r\n        return;\r\n      }\r\n      const buffer = context.createBuffer(channels, length, rate);\r\n      for (let i = 0; i < channels; ++i) {\r\n        buffer.copyToChannel(data.subarray(i * length, i * length + length), i);\r\n      }\r\n      sounds.set(id, {\r\n        buffer,\r\n        gain: context.createGain(),\r\n        panner: new StereoPannerNode(context, {pan: 0}),\r\n      });\r\n    },\r\n    duplicate_sound(id, srcId) {\r\n      if (!context) {\r\n        return;\r\n      }\r\n      const src = sounds.get(srcId);\r\n      if (!src) {\r\n        return;\r\n      }\r\n      sounds.set(id, {\r\n        buffer: src.buffer,\r\n        gain: context.createGain(),\r\n        panner: new StereoPannerNode(context, {pan: 0}),\r\n      });\r\n    },\r\n    play_sound(id, volume, pan, loop) {\r\n      const src = sounds.get(id);\r\n      if (src) {\r\n        if (src.source) {\r\n          src.source.stop();\r\n        }\r\n        src.gain.gain.value = Math.pow(2.0, volume / 1000.0);\r\n        const relVolume = Math.pow(2.0, pan / 1000.0);\r\n        src.panner.pan.value = 1.0 - 2.0 / (1.0 + relVolume);\r\n        src.source = context.createBufferSource();\r\n        src.source.buffer = src.buffer;\r\n        src.source.loop = !!loop;\r\n        src.source.connect(src.gain).connect(src.panner).connect(context.destination);\r\n        src.source.start();\r\n      }\r\n    },\r\n    set_volume(id, volume) {\r\n      const src = sounds.get(id);\r\n      if (src) {\r\n        src.gain.gain.value = Math.pow(2.0, volume / 1000.0);\r\n      }\r\n    },\r\n    stop_sound(id) {\r\n      const src = sounds.get(id);\r\n      if (src && src.source) {\r\n        src.source.stop();\r\n        delete src.source;\r\n      }\r\n    },\r\n    delete_sound(id) {\r\n      const src = sounds.get(id);\r\n      if (src && src.source) {\r\n        src.source.stop();\r\n      }\r\n      sounds.delete(id);\r\n    },\r\n\r\n    stop_all() {\r\n      for (let [, sound] of sounds) {\r\n        if (sound.source) {\r\n          sound.source.stop();\r\n        }\r\n      }\r\n      sounds.clear();\r\n      context = null;\r\n    }\r\n  };\r\n}\r\n","import React from 'react';\r\nimport './App.scss';\r\nimport classNames from 'classnames';\r\nimport ReactGA from 'react-ga';\r\n\r\nimport create_fs from './fs';\r\nimport load_game from './api/loader';\r\nimport { SpawnSize } from './api/load_spawn';\r\n\r\nif (process.env.NODE_ENV === 'production') {\r\n  ReactGA.initialize('UA-43123589-6');\r\n  ReactGA.pageview('/');\r\n}\r\n\r\nfunction reportLink(e, retail) {\r\n  const message = e.stack || e.message || \"Unknown error\";\r\n  const url = new URL(\"https://github.com/d07RiV/diabloweb/issues/new\");\r\n  url.searchParams.set(\"body\",\r\n`**Description:**\r\n[Please describe what you were doing before the error occurred]\r\n\r\n**App version:**\r\nDiabloWeb ${process.env.VERSION} (${retail ? 'Retail' : 'Shareware'})\r\n\r\n**Error message:**\r\n    \r\n${message.split(\"\\n\").map(line => \"    \" + line).join(\"\\n\")}\r\n\r\n**User agent:**\r\n\r\n    ${navigator.userAgent}\r\n\r\n**Save file:**\r\n[Please attach the save file, if applicable. The error box should have a link to download the current save you were playing; alternatively, you can open dev console on the game page (F12) and type in ${\"`DownloadSaves()`\"}]\r\n`);\r\n  return url.toString();\r\n}\r\n\r\nfunction isDropFile(e) {\r\n  if (e.dataTransfer.items) {\r\n    for (let i = 0; i < e.dataTransfer.items.length; ++i) {\r\n      if (e.dataTransfer.items[i].kind === \"file\") {\r\n        return true;\r\n      }\r\n    }\r\n  } if (e.dataTransfer.files.length) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\nfunction getDropFile(e) {\r\n  if (e.dataTransfer.items) {\r\n    for (let i = 0; i < e.dataTransfer.items.length; ++i) {\r\n      if (e.dataTransfer.items[i].kind === \"file\") {\r\n        return e.dataTransfer.items[i].getAsFile();\r\n      }\r\n    }\r\n  } if (e.dataTransfer.files.length) {\r\n    return e.dataTransfer.files[0];\r\n  }\r\n}\r\n\r\nconst TOUCH_MOVE = 0;\r\nconst TOUCH_RMB = 1;\r\nconst TOUCH_SHIFT = 2;\r\n\r\nconst Link = ({children, ...props}) => <a target=\"_blank\" rel=\"noopener noreferrer\" {...props}>{children}</a>;\r\n\r\nclass App extends React.Component {\r\n  files = new Map();\r\n  state = {started: false, loading: false, touch: false, dropping: 0, has_spawn: false};\r\n  cursorPos = {x: 0, y: 0};\r\n\r\n  touchButtons = [null, null, null, null, null, null];\r\n  touchCtx = [null, null, null, null, null, null];\r\n  touchMods = [false, false, false, false, false, false];\r\n  touchBelt = [-1, -1, -1, -1, -1, -1];\r\n\r\n  fs = create_fs(true);\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.setTouch0 = this.setTouch_.bind(this, 0);\r\n    this.setTouch1 = this.setTouch_.bind(this, 1);\r\n    this.setTouch2 = this.setTouch_.bind(this, 2);\r\n    this.setTouch3 = this.setTouchBelt_.bind(this, 3);\r\n    this.setTouch4 = this.setTouchBelt_.bind(this, 4);\r\n    this.setTouch5 = this.setTouchBelt_.bind(this, 5);\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"drop\", this.onDrop, true);\r\n    document.addEventListener(\"dragover\", this.onDragOver, true);\r\n    document.addEventListener(\"dragenter\", this.onDragEnter, true);\r\n    document.addEventListener(\"dragleave\", this.onDragLeave, true);\r\n\r\n    this.fs.then(fs => {\r\n      const spawn = fs.files.get('spawn.mpq');\r\n      if (spawn && spawn.byteLength === SpawnSize) {\r\n        this.setState({has_spawn: true});\r\n      }\r\n    });\r\n  }\r\n\r\n  onDrop = e => {\r\n    const file = getDropFile(e);\r\n    if (file) {\r\n      e.preventDefault();\r\n      this.start(file);\r\n    }\r\n    this.setState({dropping: 0});\r\n  }\r\n  onDragEnter = e => {\r\n    e.preventDefault();\r\n    this.setDropping(1);\r\n  }\r\n  onDragOver = e => {\r\n    if (isDropFile(e)) {\r\n      e.preventDefault();\r\n    }\r\n  }\r\n  onDragLeave = e => {\r\n    this.setDropping(-1);\r\n  }\r\n  setDropping(inc) {\r\n    this.setState(({dropping}) => ({dropping: Math.max(dropping + inc, 0)}));\r\n  }\r\n\r\n  onError(message, stack) {\r\n    this.setState(({error}) => !error && {error: {message, stack}});\r\n  }\r\n\r\n  openKeyboard(open) {\r\n    if (open) {\r\n      this.showKeyboard = true;\r\n      this.element.classList.add(\"keyboard\");\r\n      this.keyboard.focus();\r\n    } else {\r\n      this.showKeyboard = false;\r\n      this.element.classList.remove(\"keyboard\");\r\n      this.keyboard.blur();\r\n    }\r\n  }\r\n\r\n  setCursorPos(x, y) {\r\n    const rect = this.canvas.getBoundingClientRect();\r\n    this.cursorPos = {\r\n      x: rect.left + (rect.right - rect.left) * x / 640,\r\n      y: rect.top + (rect.bottom - rect.top) * y / 480,\r\n    };\r\n    setTimeout(() => {\r\n      this.game(\"DApi_Mouse\", 0, 0, 0, x, y);\r\n    });\r\n  }\r\n\r\n  onProgress(progress) {\r\n    this.setState({progress});\r\n  }\r\n\r\n  onExit() {\r\n    if (!this.state.error) {\r\n      window.location.reload();\r\n    }\r\n  }\r\n\r\n  setCurrentSave(name) {\r\n    this.saveName = name;\r\n  }\r\n  downloadSave = e => {\r\n    this.fs.then(fs => this.saveName && fs.download(this.saveName));\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n  }\r\n\r\n  drawBelt(idx, slot) {\r\n    if (!this.canvas) return;\r\n    if (!this.touchButtons[idx]) {\r\n      return;\r\n    }\r\n    this.touchBelt[idx] = slot;\r\n    if (slot >= 0) {\r\n      this.touchButtons[idx].style.display = \"block\";\r\n      this.touchCtx[idx].drawImage(this.canvas, 205 + 29 * slot, 357, 28, 28, 0, 0, 28, 28);\r\n    } else {\r\n      this.touchButtons[idx].style.display = \"none\";\r\n    }\r\n  }\r\n\r\n  updateBelt(belt) {\r\n    if (belt) {\r\n      const used = new Set();\r\n      let pos = 3;\r\n      for (let i = 0; i < belt.length && pos < 6; ++i) {\r\n        if (belt[i] >= 0 && !used.has(belt[i])) {\r\n          this.drawBelt(pos++, i);\r\n          used.add(belt[i]);\r\n        }\r\n      }\r\n      for (; pos < 6; ++pos) {\r\n        this.drawBelt(pos, -1);\r\n      }\r\n    } else {\r\n      this.drawBelt(3, -1);\r\n      this.drawBelt(4, -1);\r\n      this.drawBelt(5, -1);\r\n    }\r\n  }\r\n\r\n  start(file) {\r\n    if (file && file.name.match(/\\.sv$/i)) {\r\n      this.fs.then(fs => fs.upload(file)).then(console.log(`Updated ${file.name}`));\r\n      return;\r\n    }\r\n\r\n    document.removeEventListener(\"drop\", this.onDrop, true);\r\n    document.removeEventListener(\"dragover\", this.onDragOver, true);\r\n    document.removeEventListener(\"dragenter\", this.onDragEnter, true);\r\n    document.removeEventListener(\"dragleave\", this.onDragLeave, true);\r\n    this.setState({dropping: 0});\r\n\r\n    const retail = !!(file && file.name.match(/^diabdat\\.mpq$/i));\r\n    if (process.env.NODE_ENV === 'production') {\r\n      ReactGA.event({\r\n        category: 'Game',\r\n        action: retail ? 'Start Retail' : 'Start Shareware',\r\n      });\r\n    }\r\n\r\n    this.setState({loading: true, retail});\r\n\r\n    load_game(this, file).then(game => {\r\n      this.game = game;\r\n\r\n      document.addEventListener('mousemove', this.onMouseMove, true);\r\n      document.addEventListener('mousedown', this.onMouseDown, true);\r\n      document.addEventListener('mouseup', this.onMouseUp, true);\r\n      document.addEventListener('keydown', this.onKeyDown, true);\r\n      document.addEventListener('keyup', this.onKeyUp, true);\r\n      document.addEventListener('contextmenu', this.onMenu, true);\r\n\r\n      document.addEventListener('touchstart', this.onTouchStart, {passive: false, capture: true});\r\n      document.addEventListener('touchmove', this.onTouchMove, {passive: false, capture: true});\r\n      document.addEventListener('touchend', this.onTouchEnd, {passive: false, capture: true});\r\n\r\n      document.addEventListener('pointerlockchange', this.onPointerLockChange);\r\n      document.addEventListener('fullscreenchange', this.onFullscreenChange);\r\n      window.addEventListener('resize', this.onResize);\r\n\r\n      this.setState({started: true});\r\n    }, e => this.onError(e.message, e.stack));\r\n  }\r\n\r\n  pointerLocked() {\r\n    return document.pointerLockElement === this.canvas || document.mozPointerLockElement === this.canvas;\r\n  }\r\n\r\n  mousePos(e) {\r\n    const rect = this.canvas.getBoundingClientRect();\r\n    if (this.pointerLocked()) {\r\n      this.cursorPos.x = Math.max(rect.left, Math.min(rect.right, this.cursorPos.x + e.movementX));\r\n      this.cursorPos.y = Math.max(rect.top, Math.min(rect.bottom, this.cursorPos.y + e.movementY));\r\n    } else {\r\n      this.cursorPos = {x: e.clientX, y: e.clientY};\r\n    }\r\n    return {\r\n      x: Math.max(0, Math.min(Math.round((this.cursorPos.x - rect.left) / (rect.right - rect.left) * 640), 639)),\r\n      y: Math.max(0, Math.min(Math.round((this.cursorPos.y - rect.top) / (rect.bottom - rect.top) * 480), 479)),\r\n    };\r\n  }\r\n\r\n  mouseButton(e) {\r\n    switch (e.button) {\r\n    case 0: return 1;\r\n    case 1: return 4;\r\n    case 2: return 2;\r\n    case 3: return 5;\r\n    case 4: return 6;\r\n    default: return 1;\r\n    }\r\n  }\r\n  eventMods(e) {\r\n    return ((e.shiftKey || this.touchMods[TOUCH_SHIFT]) ? 1 : 0) + (e.ctrlKey ? 2 : 0) + (e.altKey ? 4 : 0) + (e.touches ? 8 : 0);\r\n  }\r\n\r\n  onResize = () => {\r\n    document.exitPointerLock();\r\n  }\r\n\r\n  onPointerLockChange = () => {\r\n    if (window.screen && window.innerHeight === window.screen.height && !this.pointerLocked()) {\r\n      // assume that the user pressed escape\r\n      this.game(\"DApi_Key\", 0, 0, 27);\r\n      this.game(\"DApi_Key\", 1, 0, 27);\r\n    }\r\n  }\r\n\r\n  onMouseMove = e => {\r\n    if (!this.canvas) return;\r\n    const {x, y} = this.mousePos(e);\r\n    this.game(\"DApi_Mouse\", 0, 0, this.eventMods(e), x, y);\r\n    e.preventDefault();\r\n  }\r\n\r\n  onMouseDown = e => {\r\n    if (!this.canvas) return;\r\n    const {x, y} = this.mousePos(e);\r\n    if (window.screen && window.innerHeight === window.screen.height) {\r\n      // we're in fullscreen, let's get pointer lock!\r\n      if (!this.pointerLocked()) {\r\n        this.canvas.requestPointerLock();\r\n      }\r\n    }\r\n    this.game(\"DApi_Mouse\", 1, this.mouseButton(e), this.eventMods(e), x, y);\r\n    e.preventDefault();\r\n  }\r\n\r\n  onMouseUp = e => {\r\n    if (!this.canvas) return;\r\n    const {x, y} = this.mousePos(e);\r\n    this.game(\"DApi_Mouse\", 2, this.mouseButton(e), this.eventMods(e), x, y);\r\n    e.preventDefault();\r\n  }\r\n\r\n  onKeyDown = e => {\r\n    if (!this.canvas) return;\r\n    this.game(\"DApi_Key\", 0, this.eventMods(e), e.keyCode);\r\n    if (e.keyCode >= 32 && e.key.length === 1 && !this.showKeyboard) {\r\n      this.game(\"DApi_Char\", e.key.charCodeAt(0));\r\n    }\r\n    this.clearKeySel();\r\n    if (!this.showKeyboard) {\r\n      if (e.keyCode === 8 || (e.keyCode >= 112 && e.keyCode <= 119)) {\r\n        e.preventDefault();\r\n      }\r\n    }\r\n  }\r\n\r\n  onMenu = e => {\r\n    e.preventDefault();\r\n  }\r\n\r\n  onKeyUp = e => {\r\n    if (!this.canvas) return;\r\n    this.game(\"DApi_Key\", 1, this.eventMods(e), e.keyCode);\r\n    this.clearKeySel();\r\n  }\r\n\r\n  clearKeySel() {\r\n    if (this.showKeyboard) {\r\n      const len = this.keyboard.value.length;\r\n      this.keyboard.setSelectionRange(len, len);\r\n    }\r\n  }\r\n\r\n  onKeyboard = () => {\r\n    if (this.showKeyboard) {\r\n      const text = this.keyboard.value;\r\n      const valid = (text.match(/[\\x20-\\x7E]/g) || []).join(\"\").substring(0, 15);\r\n      if (text !== valid) {\r\n        this.keyboard.value = valid;\r\n      }\r\n      this.clearKeySel();\r\n      const values = [...Array(15)].map((_, i) => i < valid.length ? valid.charCodeAt(i) : 0);\r\n      this.game(\"DApi_SyncText\", ...values);\r\n    }\r\n  }\r\n\r\n  parseFile = e => {\r\n    const files = e.target.files;\r\n    if (files.length > 0) {\r\n      this.start(files[0]);\r\n    }\r\n  }\r\n\r\n  touchButton = null;\r\n  touchCanvas = null;\r\n\r\n  onFullscreenChange = () => {\r\n    this.setState({touch: (document.fullscreenElement === this.element)});\r\n  }\r\n\r\n  setTouchMod(index, value, use) {\r\n    if (index < 3) {\r\n      this.touchMods[index] = value;\r\n      if (this.touchButtons[index]) {\r\n        this.touchButtons[index].classList.toggle(\"active\", value);\r\n      }\r\n    } else if (use && this.touchBelt[index] >= 0) {\r\n      const now = performance.now();\r\n      if (!this.beltTime || now - this.beltTime > 750) {\r\n        this.game(\"DApi_Char\", 49 + this.touchBelt[index]);\r\n        this.beltTime = now;\r\n      }\r\n    }\r\n  }\r\n\r\n  updateTouchButton(touches, release) {\r\n    let touchOther = null;\r\n    const btn = this.touchButton;\r\n    for (let {target, identifier, clientX, clientY} of touches) {\r\n      if (btn && btn.id === identifier && this.touchButtons[btn.index] === target) {\r\n        if (touches.length > 1) {\r\n          btn.stick = false;\r\n        }\r\n        btn.clientX = clientX;\r\n        btn.clientY = clientY;\r\n        this.touchCanvas = [...touches].find(t => t.identifier !== identifier);\r\n        if (this.touchCanvas) {\r\n          this.touchCanvas = {clientX: this.touchCanvas.clientX, clientY: this.touchCanvas.clientY};\r\n        }\r\n        delete this.panPos;\r\n        return this.touchCanvas != null;\r\n      }\r\n      const idx = this.touchButtons.indexOf(target);\r\n      if (idx >= 0 && !touchOther) {\r\n        touchOther = {id: identifier, index: idx, stick: true, original: this.touchMods[idx], clientX, clientY};\r\n      }\r\n    }\r\n    if (btn && !touchOther && release && btn.stick) {\r\n      const rect = this.touchButtons[btn.index].getBoundingClientRect();\r\n      const {clientX, clientY} = btn;\r\n      if (clientX >= rect.left && clientX < rect.right && clientY >= rect.top && clientY < rect.bottom) {\r\n        this.setTouchMod(btn.index, !btn.original, true);\r\n      } else {\r\n        this.setTouchMod(btn.index, btn.original);\r\n      }\r\n    } else if (btn) {\r\n      this.setTouchMod(btn.index, false);\r\n    }\r\n    this.touchButton = touchOther;\r\n    if (touchOther) {\r\n      this.setTouchMod(touchOther.index, true);\r\n      if (touchOther.index === TOUCH_MOVE) {\r\n        this.setTouchMod(TOUCH_RMB, false);\r\n      } else if (touchOther.index === TOUCH_RMB) {\r\n        this.setTouchMod(TOUCH_MOVE, false);\r\n      }\r\n      delete this.panPos;\r\n    } else if (touches.length === 2) {\r\n      const x = (touches[1].clientX + touches[0].clientX) / 2, y = (touches[1].clientY + touches[0].clientY) / 2;\r\n      if (this.panPos) {\r\n        const dx = x - this.panPos.x, dy = y - this.panPos.y;\r\n        const step = this.canvas.offsetHeight / 12;\r\n        if (Math.max(Math.abs(dx), Math.abs(dy)) > step) {\r\n          let key;\r\n          if (Math.abs(dx) > Math.abs(dy)) {\r\n            key = (dx > 0 ? 0x25 : 0x27);\r\n          } else {\r\n            key = (dy > 0 ? 0x26 : 0x28);\r\n          }\r\n          this.game(\"DApi_Key\", 0, 0, key);\r\n          // key up is ignored anyway\r\n          this.panPos = {x, y};\r\n        }\r\n      } else {\r\n        this.game(\"DApi_Mouse\", 0, 0, 24, 320, 180);\r\n        this.game(\"DApi_Mouse\", 2, 1, 24, 320, 180);\r\n        this.panPos = {x, y};\r\n      }\r\n      this.touchCanvas = null;\r\n      return false;\r\n    } else {\r\n      delete this.panPos;\r\n    }\r\n    this.touchCanvas = [...touches].find(t => !touchOther || t.identifier !== touchOther.id);\r\n    if (this.touchCanvas) {\r\n      this.touchCanvas = {clientX: this.touchCanvas.clientX, clientY: this.touchCanvas.clientY};\r\n    }\r\n    return this.touchCanvas != null;\r\n  }\r\n\r\n  onTouchStart = e => {\r\n    if (!this.canvas) return;\r\n    e.preventDefault();\r\n    if (this.updateTouchButton(e.touches, false)) {\r\n      const {x, y} = this.mousePos(this.touchCanvas);\r\n      this.game(\"DApi_Mouse\", 0, 0, this.eventMods(e), x, y);\r\n      if (!this.touchMods[TOUCH_MOVE]) {\r\n        this.game(\"DApi_Mouse\", 1, this.touchMods[TOUCH_RMB] ? 2 : 1, this.eventMods(e), x, y);\r\n      }\r\n    }\r\n  }\r\n  onTouchMove = e => {\r\n    if (!this.canvas) return;\r\n    e.preventDefault();\r\n    if (this.updateTouchButton(e.touches, false)) {\r\n      const {x, y} = this.mousePos(this.touchCanvas);\r\n      this.game(\"DApi_Mouse\", 0, 0, this.eventMods(e), x, y);\r\n    }\r\n  }\r\n  onTouchEnd = e => {\r\n    if (!this.canvas) return;\r\n    e.preventDefault();\r\n    const prevTc = this.touchCanvas;\r\n    this.updateTouchButton(e.touches, true);\r\n    if (prevTc && !this.touchCanvas) {\r\n      const {x, y} = this.mousePos(prevTc);\r\n      this.game(\"DApi_Mouse\", 2, 1, this.eventMods(e), x, y);\r\n      this.game(\"DApi_Mouse\", 2, 2, this.eventMods(e), x, y);\r\n\r\n      if (this.touchMods[TOUCH_RMB] && (!this.touchButton || this.touchButton.index !== TOUCH_RMB)) {\r\n        this.setTouchButton(TOUCH_RMB, false);\r\n      }\r\n    }\r\n    if (!document.fullscreenElement) {\r\n      this.element.requestFullscreen();\r\n    }\r\n  }\r\n\r\n  setCanvas = e => this.canvas = e;\r\n  setElement = e => this.element = e;\r\n  setKeyboard = e => this.keyboard = e;\r\n  setTouch_(i, e) {\r\n    this.touchButtons[i] = e;\r\n  }\r\n  setTouchBelt_(i, e) {\r\n    this.touchButtons[i] = e;\r\n    if (e) {\r\n      const canvas = document.createElement(\"canvas\");\r\n      canvas.width = 28;\r\n      canvas.height = 28;\r\n      e.appendChild(canvas);\r\n      this.touchCtx[i] = canvas.getContext(\"2d\");\r\n    } else {\r\n      this.touchCtx[i] = null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {started, loading, error, progress, dropping, touch, has_spawn} = this.state;\r\n    return (\r\n      <div className={classNames(\"App\", {touch, started, dropping, keyboard: this.showKeyboard})} ref={this.setElement}>\r\n        <div className=\"touch-ui touch-mods\">\r\n          <div className={classNames(\"touch-button\", \"touch-button-0\", {active: this.touchMods[0]})} ref={this.setTouch0}/>\r\n          <div className={classNames(\"touch-button\", \"touch-button-1\", {active: this.touchMods[1]})} ref={this.setTouch1}/>\r\n          <div className={classNames(\"touch-button\", \"touch-button-2\", {active: this.touchMods[2]})} ref={this.setTouch2}/>\r\n        </div>\r\n        <div className=\"touch-ui touch-belt\">\r\n          <div className={classNames(\"touch-button\", \"touch-button-0\")} ref={this.setTouch3}/>\r\n          <div className={classNames(\"touch-button\", \"touch-button-1\")} ref={this.setTouch4}/>\r\n          <div className={classNames(\"touch-button\", \"touch-button-2\")} ref={this.setTouch5}/>\r\n        </div>\r\n        <div className=\"Body\">\r\n          {!error && <canvas ref={this.setCanvas} width={640} height={480}/>}\r\n          <input type=\"text\" className=\"keyboard\" onChange={this.onKeyboard} ref={this.setKeyboard} spellCheck={false}/>\r\n        </div>\r\n        <div className=\"BodyV\">\r\n          {!!error && (\r\n            <Link className=\"error\" href={reportLink(error, this.state.retail)}>\r\n              <p className=\"header\">The following error has occurred:</p>\r\n              <p className=\"body\">{error.message}</p>\r\n              <p className=\"footer\">Click to create an issue on GitHub</p>\r\n              {this.saveName != null && <p className=\"link\" onClick={this.downloadSave}>Download save file</p>}\r\n            </Link>\r\n          )}\r\n          {!!loading && !started && !error && (\r\n            <div className=\"loading\">\r\n              {(progress && progress.text) || 'Loading...'}\r\n              {progress != null && !!progress.total && (\r\n                <span className=\"progressBar\"><span><span style={{width: `${Math.round(100 * progress.loaded / progress.total)}%`}}/></span></span>\r\n              )}\r\n            </div>\r\n          )}\r\n          {!started && !loading && !error && (\r\n            <div className=\"start\">\r\n              <p>\r\n                This is a web port of the original Diablo game, based on source code reconstructed by\r\n                GalaXyHaXz and devilution team: <Link href=\"https://github.com/diasurgical/devilution\">https://github.com/diasurgical/devilution</Link>\r\n              </p>\r\n              <p>\r\n                If you own the original game, you can drop the original DIABDAT.MPQ onto this page or click the button below to start playing.\r\n                The game can be purchased from <Link href=\"https://www.gog.com/game/diablo\">GoG</Link>.\r\n              </p>\r\n              {!has_spawn && (\r\n                <p>\r\n                  Or you can play the shareware version for free (50MB download).\r\n                </p>\r\n              )}\r\n              <form>\r\n                <label htmlFor=\"loadFile\" className=\"startButton\">Select MPQ</label>\r\n                <input accept=\".mpq\" type=\"file\" id=\"loadFile\" style={{display: \"none\"}} onChange={this.parseFile}/>\r\n              </form>\r\n              <span className=\"startButton\" onClick={() => this.start()}>Play Shareware</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './reset.css';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\nserviceWorker.register();\r\n","import IdbKvStore from  'idb-kv-store';\r\n\r\nconst importStorage = () => new Promise((resolve, reject) => {\r\n  let done = false;\r\n  const frame = document.createElement('iframe');\r\n  window.addEventListener('message', ({data}) => {\r\n    if (data.method === 'storage' && !done) {\r\n      done = true;\r\n      resolve(data.files);\r\n      frame.contentWindow.postMessage({method: 'clear'}, '*');\r\n    }\r\n  });\r\n  frame.addEventListener('load', () => {\r\n    frame.contentWindow.postMessage({method: 'transfer'}, '*');\r\n  });\r\n  frame.addEventListener('error', () => {\r\n    if (!done) {\r\n      done = true;\r\n      resolve(null);\r\n    }\r\n  });\r\n  frame.src = \"https://diablo.rivsoft.net/storage.html\";\r\n  frame.style.display = \"none\";\r\n  document.body.appendChild(frame);\r\n  setTimeout(() => {\r\n    if (!done) {\r\n      done = true;\r\n      resolve(null);\r\n    }\r\n  }, 10000);\r\n});\r\n\r\nasync function downloadFile(store, name) {\r\n  const file = await store.get(name.toLowerCase());\r\n  if (file) {\r\n    const blob = new Blob([file], {type: 'binary/octet-stream'});\r\n    const url = URL.createObjectURL(blob);\r\n    const lnk = document.createElement('a');\r\n    lnk.setAttribute('href', url);\r\n    lnk.setAttribute('download', name);\r\n    document.body.appendChild(lnk);\r\n    lnk.click();\r\n    document.body.removeChild(lnk);\r\n    URL.revokeObjectURL(url);\r\n  } else {\r\n    console.error(`File ${name} does not exist`);\r\n  }\r\n}\r\n\r\nasync function downloadSaves(store) {\r\n  for (let name of await store.keys()) {\r\n    if (name.match(/\\.sv$/i)) {\r\n      downloadFile(store, name);\r\n    }\r\n  }\r\n}\r\n\r\nconst readFile = file => new Promise((resolve, reject) => {\r\n  const reader = new FileReader();\r\n  reader.onload = () => resolve(reader.result);\r\n  reader.onerror = () => reject(reader.error);\r\n  reader.onabort = () => reject();\r\n  reader.readAsArrayBuffer(file);\r\n});\r\nasync function uploadFile(store, files, file) {\r\n  const data = new Uint8Array(await readFile(file));\r\n  files.set(file.name.toLowerCase(), data);\r\n  return store.set(file.name.toLowerCase(), data);\r\n}\r\n\r\nexport default async function create_fs(load) {\r\n  try {\r\n    const store = new IdbKvStore('diablo_fs');\r\n    const files = new Map();\r\n    for (let [name, data] of Object.entries(await store.json())) {\r\n      files.set(name, data);\r\n    }\r\n    if (load) {\r\n      const files = await importStorage();\r\n      if (files) {\r\n        for (let [name, data] of files) {\r\n          files.set(name, data);\r\n          store.set(name, data);\r\n        }\r\n      }\r\n    }\r\n    window.DownloadFile = name => downloadFile(store, name);\r\n    window.DownloadSaves = () => downloadSaves(store);\r\n    return {\r\n      files,\r\n      update: (name, data) => store.set(name, data),\r\n      delete: name => store.remove(name),\r\n      clear: () => store.clear(),\r\n      download: name => downloadFile(store, name),\r\n      upload: file => uploadFile(store, files, file),\r\n    };\r\n  } catch (e) {\r\n    window.DownloadFile = () => console.error('IndexedDB is not supported');\r\n    window.DownloadSaves = () => console.error('IndexedDB is not supported');\r\n    return {\r\n      files: new Map(),\r\n      update: () => Promise.resolve(),\r\n      delete: () => Promise.resolve(),\r\n      clear: () => Promise.resolve(),\r\n      download: () => Promise.resolve(),\r\n      upload: () => Promise.resolve(),\r\n    };\r\n  }  \r\n}\r\n"],"sourceRoot":""}